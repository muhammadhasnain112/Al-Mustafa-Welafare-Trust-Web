<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Management System</title>
  <style>
    :root {
      --primary-color: #4361ee;
      --secondary-color: #3f37c9;
      --accent-color: #4895ef;
      --light-gray: #f8f9fa;
      --medium-gray: #e9ecef;
      --dark-gray: #495057;
      --success-color: #4bb543;
      --warning-color: #fca311;
      --danger-color: #e63946;
      --info-color: #17a2b8;
      --enrolled-color: #4361ee;
      --completed-color: #4bb543;
      --dropout-color: #e63946;
      --certified-color: #9c36b5;
    }

    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f7ff;
      color: #333;
      line-height: 1.6;
      display: flex;
      min-height: 100vh;
    }

    /* Left Navigation Panel */
    .side-nav-panel {
      width: 250px;
      background: linear-gradient(135deg,
          var(--primary-color),
          var(--secondary-color));
      color: white;
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
      z-index: 1000;
      transform: translateX(0);
    }

    .nav-header {
      padding: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .nav-header h3 {
      margin: 0;
      font-size: 1.1rem;
    }

    .close-nav {
      background: none;
      border: none;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      padding: 5px;
    }

    .nav-items {
      padding: 15px 0;
    }

    .nav-btn {
      width: 100%;
      padding: 12px 20px;
      background: transparent;
      border: none;
      color: white;
      text-align: left;
      cursor: pointer;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.2s;
    }

    .nav-btn:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    .nav-btn i {
      width: 20px;
      text-align: center;
    }

    .menu-toggle {
      display: none;
      position: fixed;
      top: 20px;
      left: 20px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 1.2rem;
      cursor: pointer;
      z-index: 1100;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      flex: 1;
      margin-left: 250px;
      transition: margin-left 0.3s ease;
    }

    /* Search and Filter Section */
    .search-filter-container {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 20px;
      align-items: flex-end;
    }

    .search-box {
      flex: 1;
      min-width: 250px;
    }

    .search-input {
      width: 50%;
      padding: 10px 15px;
      border: 1px solid var(--medium-gray);
      border-radius: 6px;
      font-size: 0.95rem;
      transition: all 0.3s;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(72, 149, 239, 0.2);
    }

    .filter-btn {
      background-color: white;
      color: var(--primary-color);
      border: 1px solid var(--primary-color);
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .filter-btn:hover {
      background-color: var(--primary-color);
      color: white;
    }

    .filter-btn.active {
      background-color: var(--primary-color);
      color: white;
    }

    .filter-panel {
      display: none;
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--medium-gray);
    }

    .filter-panel.active {
      display: block;
    }

    .filter-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 15px;
    }

    .filter-group {
      margin-bottom: 10px;
    }

    .filter-group label {
      display: block;
      margin-bottom: 5px;
      font-size: 0.9rem;
      color: var(--dark-gray);
    }

    .filter-group select {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid var(--medium-gray);
      border-radius: 6px;
      font-size: 0.9rem;
      background-color: white;
    }

    .filter-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 10px;
    }

    .apply-filter {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
    }

    .reset-filter {
      background-color: var(--light-gray);
      color: var(--dark-gray);
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
    }

    /* Stats Cards */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      display: flex;
      align-items: center;
      gap: 15px;
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
    }

    .stat-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
    }

    .stat-info {
      flex: 1;
    }

    .stat-title {
      font-size: 0.9rem;
      color: var(--dark-gray);
      margin: 0 0 5px 0;
    }

    .stat-value {
      font-size: 1.8rem;
      font-weight: 600;
      margin: 0;
    }

    .stat-change {
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .stat-change.up {
      color: var(--success-color);
    }

    .stat-change.down {
      color: var(--danger-color);
    }

    /* Header */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--medium-gray);
    }

    h1 {
      color: var(--primary-color);
      margin: 0;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logout-btn {
      background-color: var(--danger-color);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logout-btn:hover {
      background-color: #c1121f;
      transform: translateY(-1px);
    }

    /* Table */
    .table-container {
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      overflow: hidden;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead {
      background: linear-gradient(135deg,
          var(--primary-color),
          var(--secondary-color));
      color: white;
    }

    th {
      padding: 16px 12px;
      text-align: left;
      font-weight: 500;
      position: relative;
    }

    th:not(:last-child)::after {
      content: "";
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      height: 60%;
      width: 1px;
      background-color: rgba(255, 255, 255, 0.3);
    }

    tbody tr {
      border-bottom: 1px solid var(--medium-gray);
      transition: all 0.2s;
    }

    tbody tr:last-child {
      border-bottom: none;
    }

    tbody tr:hover {
      background-color: var(--light-gray);
    }

    td {
      padding: 14px 12px;
      color: var(--dark-gray);
      vertical-align: middle;
    }

    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }

    .pagination button {
      padding: 8px 16px;
      border: 1px solid var(--medium-gray);
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
    }

    .pagination .disabled {
      background-color: var(--light-gray);
      cursor: not-allowed;
    }

    .action-btns {
      display: flex;
      gap: 8px;
    }

    .btn {
      padding: 6px 12px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;
    }

    .btn-view {
      background-color: rgba(72, 149, 239, 0.1);
      color: var(--accent-color);
    }

    .btn-view:hover {
      background-color: rgba(72, 149, 239, 0.2);
    }

    .btn-edit {
      background-color: rgba(255, 193, 7, 0.1);
      color: #ffc107;
    }

    .btn-edit:hover {
      background-color: rgba(255, 193, 7, 0.2);
    }

    .btn-delete {
      background-color: rgba(230, 57, 70, 0.1);
      color: var(--danger-color);
    }

    .btn-delete:hover {
      background-color: rgba(230, 57, 70, 0.2);
    }

    /* Status dropdown styles */
    .status-wrapper {
      position: relative;
      height: 100%;
      display: flex;
      align-items: center;
    }

    .status-container {
      display: inline-block;
      position: relative;
      min-width: 100px;
    }

    .current-status {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      justify-content: space-between;
    }

    .status-dropdown {
      display: none;
      position: absolute;
      left: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      z-index: 100;
      min-width: 150px;
      padding: 5px 0;
      max-height: 200px;
      overflow-y: auto;
    }

    .status-option {
      padding: 8px 15px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: background-color 0.2s;
    }

    .status-option:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    /* Status color classes */
    .status-enrolled {
      background-color: rgba(67, 97, 238, 0.1);
      color: var(--enrolled-color);
    }

    .status-completed {
      background-color: rgba(75, 181, 67, 0.1);
      color: var(--completed-color);
    }

    .status-dropout {
      background-color: rgba(230, 57, 70, 0.1);
      color: var(--dropout-color);
    }

    .status-certified {
      background-color: rgba(156, 54, 181, 0.1);
      color: var(--certified-color);
    }

    .status-pending {
      background-color: rgba(252, 163, 17, 0.1);
      color: var(--warning-color);
    }

    .status-unknown {
      background-color: var(--light-gray);
      color: var(--dark-gray);
    }

    /* Messages */
    #msg {
      text-align: center;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 6px;
    }

    .error-msg {
      background-color: rgba(230, 57, 70, 0.1);
      color: var(--danger-color);
    }

    .success-msg {
      background-color: rgba(75, 181, 67, 0.1);
      color: var(--success-color);
    }

    /* Improved Side Panel Styles */
    .side-panel {
      width: 420px;
      background-color: white;
      border-radius: 10px 0 0 10px;
      box-shadow: -5px 0 30px rgba(0, 0, 0, 0.1);
      position: fixed;
      top: 0;
      right: -450px;
      bottom: 0;
      overflow-y: auto;
      transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      border-left: 1px solid rgba(0, 0, 0, 0.1);
    }

    .side-panel.active {
      right: 0;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background-color: var(--primary-color);
      color: white;
      position: sticky;
      top: 0;
      z-index: 1;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .panel-header h2 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .close-panel {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      color: white;
      padding: 5px;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .close-panel:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }

    .panel-content {
      padding: 25px;
      flex: 1;
      background-color: #f9fafb;
    }

    .student-profile {
      text-align: center;
      margin-bottom: 30px;
      position: relative;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
    }

    .student-image-container {
      position: relative;
      width: 140px;
      height: 140px;
      margin: 0 auto 15px;
    }

    .student-image {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
      border: 5px solid white;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    }

    .student-name {
      font-size: 1.5rem;
      font-weight: 600;
      margin: 10px 0 5px;
      color: var(--dark-gray);
    }

    .student-id {
      color: var(--accent-color);
      font-weight: 500;
      margin-bottom: 15px;
      display: block;
      font-size: 0.95rem;
    }

    .status-badge {
      display: inline-block;
      padding: 6px 15px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
      margin-bottom: 5px;
    }

    .student-details {
      background-color: white;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
    }

    .detail-section {
      margin-bottom: 25px;
    }

    .detail-section h3 {
      font-size: 1.1rem;
      color: var(--primary-color);
      margin: 0 0 15px 0;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--light-gray);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .detail-section h3 i {
      color: var(--accent-color);
      width: 20px;
      text-align: center;
    }

    .detail-row {
      display: flex;
      margin-bottom: 12px;
      align-items: flex-start;
    }

    .detail-label {
      flex: 0 0 120px;
      font-weight: 500;
      color: var(--dark-gray);
      font-size: 0.9rem;
      padding: 5px 0;
    }

    .detail-value {
      flex: 1;
      color: #555;
      padding: 5px 0;
      word-break: break-word;
    }

    .panel-footer {
      padding: 15px 25px;
      background-color: white;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      border-top: 1px solid var(--medium-gray);
      position: sticky;
      bottom: 0;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
    }

    .panel-btn {
      padding: 10px 20px;
      border-radius: 6px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.95rem;
    }

    .panel-btn-edit {
      background-color: var(--accent-color);
      color: white;
      border: none;
    }

    .panel-btn-edit:hover {
      background-color: var(--secondary-color);
      transform: translateY(-1px);
    }

    .panel-btn-delete {
      background-color: white;
      color: var(--danger-color);
      border: 1px solid var(--danger-color);
    }

    .panel-btn-delete:hover {
      background-color: var(--danger-color);
      color: white;
      transform: translateY(-1px);
    }

    /* Overlay when panel is open */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 999;
      display: none;
      backdrop-filter: blur(4px);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .overlay.active {
      display: block;
      opacity: 1;
    }

    /* Status color classes for badge */
    .status-enrolled {
      background-color: rgba(67, 97, 238, 0.1);
      color: var(--enrolled-color);
    }

    .status-completed {
      background-color: rgba(75, 181, 67, 0.1);
      color: var(--completed-color);
    }

    .status-dropout {
      background-color: rgba(230, 57, 70, 0.1);
      color: var(--dropout-color);
    }

    .status-certified {
      background-color: rgba(156, 54, 181, 0.1);
      color: var(--certified-color);
    }

    .status-pending {
      background-color: rgba(252, 163, 17, 0.1);
      color: var(--warning-color);
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .side-nav-panel {
        transform: translateX(-100%);
      }

      .side-nav-panel.active {
        transform: translateX(0);
      }

      .container {
        margin-left: 0;
      }

      .menu-toggle {
        display: block;
      }

      .side-panel {
        width: 100%;
        right: -100%;
        border-radius: 0;
      }

      .side-panel.active {
        right: 0;
      }
    }

    @media (max-width: 768px) {
      .stats-container {
        grid-template-columns: 1fr;
      }

      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }

      .action-btns {
        flex-direction: column;
        gap: 5px;
      }

      .btn {
        justify-content: center;
      }

      .filter-row {
        grid-template-columns: 1fr;
      }

      .search-input {
        width: 100%;
      }

      .student-image-container {
        width: 120px;
        height: 120px;
      }

      .detail-row {
        flex-direction: column;
        gap: 5px;
      }

      .detail-label {
        flex: 1;
      }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>

<body>
  <div class="side-nav-panel" id="sideNavPanel">
    <div class="nav-header">
      <h3><i class="fas fa-bars"></i> Menu</h3>
      <button class="close-nav" onclick="toggleNavPanel()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="nav-items" id="nav">
      <button class="nav-btn" onclick="window.location.href=`student.html`">
        <i class="fas fa-user-plus"></i> Add Student
      </button>
      <button class="nav-btn" onclick="window.location.href=`addCampus.html`">
        <i class="fas fa-school"></i> Add Campus
      </button>
      <button class="nav-btn" onclick="window.location.href=`addCourse.html`">
        <i class="fas fa-book"></i> Add Course
      </button>
      <button class="nav-btn" onclick="window.location.href=`addAdmin.html`">
        <i class="fas fa-user-shield"></i> Add Admin
      </button>
      <button class="nav-btn" onclick="window.location.href=`report.html`">
        <i class="fas fa-chart-bar"></i> Reports
      </button>
      <button class="nav-btn" onclick="showSettings()">
        <i class="fas fa-cog"></i> Settings
      </button>
    </div>
  </div>

  <button class="menu-toggle" onclick="toggleNavPanel()">
    <i class="fas fa-bars"></i>
  </button>

  <div class="overlay" id="overlay"></div>

  <div class="container">
    <div class="main-content">
      <header>
        <h1><i class="fas fa-users"></i> Student Management Dashboard</h1>
        <button class="logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </header>

      <div class="search-filter-container">
        <div class="search-box">
          <label for="searchInput">Search by Roll No or CNIC</label>
          <input type="text" id="searchInput" class="search-input" placeholder="Enter roll number or CNIC..."
            onkeyup="searchStudents()" />
        </div>
        <button class="filter-btn" id="filterBtn" onclick="toggleFilterPanel()">
          <i class="fas fa-filter"></i> Filter Students
        </button>
      </div>

      <div class="filter-panel" id="filterPanel">
        <div class="filter-row">
          <div class="filter-group">
            <label for="statusFilter">Status</label>
            <select id="statusFilter">
              <option value="">All Statuses</option>
              <option value="enrolled">Enrolled</option>
              <option value="completed">Completed</option>
              <option value="dropout">Dropout</option>
              <option value="certified">Certified</option>
              <option value="pending">Pending</option>
            </select>
          </div>


          <div class="filter-group">
            <label for="courseFilter">Course Catagory</label>
            <select class="form-control" id="Course" required>
              <option value="" disabled selected>Select Category</option>
              <option value="Language">Language</option>
              <option value="IT">Information Technology</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="courseFilter">Courses</label>
            <select class="form-control" id="CourseFilter" required>
              <option value="" disabled selected>Select Course</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="branchFilter">Branch</label>
            <select id="branchFilter">
              <option value="" selected disabled>All Branches</option>
            </select>
          </div>
        </div>

        <div class="filter-row">
          <div class="filter-group">
            <label for="genderFilter">Gender</label>
            <select id="genderFilter">
              <option value="">All Genders</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="qualificationFilter">Qualification</label>
            <select id="qualificationFilter">
              <option value="">All Qualifications</option>
              <option value="Matric">Matric</option>
              <option value="Intermediate">Intermediate</option>
              <option value="Bachelor">Bachelor</option>
              <option value="Master">Master</option>
              <option value="PhD">PhD</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="dateFilter">Registration Date</label>
            <select id="dateFilter">
              <option value="">All Time</option>
              <option value="today">Today</option>
              <option value="week">This Week</option>
              <option value="month">This Month</option>
              <option value="year">This Year</option>
            </select>
          </div>
        </div>

        <div class="filter-actions">
          <button class="reset-filter" onclick="resetFilters()">
            <i class="fas fa-undo"></i> Reset
          </button>
          <button class="apply-filter" onclick="applyFilters()">
            <i class="fas fa-check"></i> Apply Filters
          </button>
        </div>
      </div>

      <div class="stats-container" id="statsContainer"></div>

      <p id="msg" class="error-msg" style="display: none"></p>

      <div class="table-container">
        <table id="studentTable">
          <thead>
            <tr>
              <th>Roll No</th>
              <th>Image</th>
              <th>Name</th>
              <th>Father Name</th>
              <th>Phone</th>
              <th>CNIC</th>
              <th>Campus</th>
              <th>Gender</th>
              <th>Course</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="pagination" id="pagination"></div>
    </div>

    <div class="side-panel" id="sidePanel">
      <div class="panel-header">
        <h2><i class="fas fa-user-graduate"></i> Student Details</h2>
        <button class="close-panel" onclick="closePanel()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="panel-content">
        <div class="student-profile">
          <div class="student-image-container">
            <img id="studentProfileImage" src="default-avatar.png" alt="Student Image" class="student-image" />
          </div>
          <h3 class="student-name" id="studentName">-</h3>
          <span class="student-id" id="studentRollNo">Roll No: -</span>
          <div class="status-badge" id="studentStatusBadge">-</div>
        </div>

        <div class="student-details">
          <div class="detail-section">
            <h3><i class="fas fa-id-card"></i> Basic Information</h3>
            <div class="detail-row">
              <span class="detail-label">Father's Name:</span>
              <span class="detail-value" id="studentFatherName">-</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Phone:</span>
              <span class="detail-value" id="studentPhone">-</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">CNIC:</span>
              <span class="detail-value" id="studentCnic">-</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Gender:</span>
              <span class="detail-value" id="studentGender">-</span>
            </div>
          </div>

          <div class="detail-section">
            <h3>
              <i class="fas fa-graduation-cap"></i> Academic Information
            </h3>
            <div class="detail-row">
              <span class="detail-label">Qualification:</span>
              <span class="detail-value" id="studentQualification">-</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Course:</span>
              <span class="detail-value" id="studentCourse">-</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Branch:</span>
              <span class="detail-value" id="studentBranch">-</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Registration Date:</span>
              <span class="detail-value" id="studentRegDate">-</span>
            </div>
          </div>

          <div class="detail-section">
            <h3><i class="fas fa-map-marker-alt"></i> Contact Information</h3>
            <div class="detail-row">
              <span class="detail-label">Address:</span>
              <span class="detail-value" id="studentAddress">-</span>
            </div>
          </div>
        </div>
      </div>

      <div class="panel-footer">
        <button class="panel-btn panel-btn-edit" onclick="editCurrentStudent()">
          <i class="fas fa-edit"></i> Edit Profile
        </button>
        <button class="panel-btn panel-btn-delete" onclick="deleteCurrentStudent()">
          <i class="fas fa-trash-alt"></i> Delete
        </button>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabaseUrl = "https://uryazsueiysgjjchkbwl.supabase.co";
    const supabaseKey = `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVyeWF6c3VlaXlzZ2pqY2hrYndsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUwMDE0MTEsImV4cCI6MjA3MDU3NzQxMX0.2WrDpY_ZDvBbtRSjmic5n1jkZk3ZSU6x5xqce6kY-8A`;
    const client = supabase.createClient(supabaseUrl, supabaseKey);

    const branchFilter = document.getElementById('branchFilter')
    branch()
    async function branch() {

      const { data: campuses, error } = await client
        .from("campuses")
        .select("*")
      campuses.forEach(element => {
        branchFilter.innerHTML += `
          <option value="${element.name}">${element.name}</option>
          `
        // console.log(element.name);
      });

    }



    const navBar = [{}];

    const courseCatagary = document.getElementById('CourseFilter')
    const courses = document.getElementById('Course')
    courses.addEventListener('change', () => {
      courseCatagary.style.display = 'block'
      if (courses.value == 'Language') {
        courseCatagary.innerHTML = `
            <option value="" selected disabled>Select Course</option>
            <option value="English">English</option>
            <option value="Chinese">Chinese</option>
            <option value="Arabic">Arabic</option>
            `
      } else {
        courseCatagary.innerHTML = `
<option value="" selected disabled>Select Course</option>
<option value="Web Development">Web Development</option>
<option value="Graphic Designing">Graphic Designing</option>
<option value="Digital Marketing">Digital Marketing</option>
<option value="Cyber Security">Cyber Security</option>
`
      }
    })

    // DOM elements
    const sideNavPanel = document.getElementById("sideNavPanel");
    const menuToggle = document.querySelector(".menu-toggle");
    const overlay = document.getElementById("overlay");
    const msgElement = document.getElementById("msg");
    const statsContainer = document.getElementById("statsContainer");
    const tableBody = document.querySelector("#studentTable tbody");
    const sidePanel = document.getElementById("sidePanel");
    const filterBtn = document.getElementById("filterBtn");
    const filterPanel = document.getElementById("filterPanel");
    const searchInput = document.getElementById("searchInput");

    // Filter variables
    let currentFilters = {
      status: "",
      course: "",
      branch: "",
      gender: "",
      qualification: "",
      date: "",
    };

    // All students data
    let allStudents = [];
    let filteredStudents = [];
    let currentPage = 1;
    const pageSize = 10;
    let currentStudentId = null;


    // Toggle navigation panel
    function toggleNavPanel() {
      sideNavPanel.classList.toggle("active");
      overlay.classList.toggle("active");
      if (sideNavPanel.classList.contains("active")) {
        document.body.style.overflow = "hidden";
      } else {
        document.body.style.overflow = "";
      }
    }

    // Close nav panel when clicking outside
    overlay.addEventListener("click", toggleNavPanel);

    // Session management
    async function checkSession() {
      const {
        data: { session },
      } = await client.auth.getSession();

      if (!session) {
        window.location.href = "index.html";
      } else {
        console.log("User ID:", session.user.id);
        let id = session.user.id;

        const { data: adminId, error } = await client
          .from("admins")
          .select("*")
          .eq("user_id", id);

        if (error) {
          console.error("Error fetching admin:", error.message);
          return;
        }

        if (adminId && adminId.length > 0) {
          console.log("Admin Status:", adminId[0].campus);

          // Load student data based on admin's campus
          await loadStudents(adminId[0].campus);

          // Now redirect after everything is ready
          // window.location.href = "dashboard.html";
        } else {
          console.log("No admin found for this user ID.");
          // Optional: redirect to error page or show alert
        }
      }
    }


    async function logout() {
      await client.auth.signOut();
      window.location.href = "index.html";
    }

    // Navigation functions

    function showSettings() {
      showMessage(
        "Settings functionality will be implemented here",
        "success"
      );
      toggleNavPanel();
    }

    // Student data functions
    async function loadStudents(campus) {
      try {
        if (!campus) {
          showMessage("Campus not specified.", "error");
          return;
        }

        const { data: students, error } = await client
          .from("students")
          .select("*")
          .eq("campus", campus)
          .order("created_at", { ascending: false });

        if (error) throw error;

        if (!students || students.length === 0) {
          showMessage("No student records found.", "error");
          return;
        }

        // Ensure these variables are defined
        allStudents = students;
        filteredStudents = [...students];

        console.log("Students loaded:", students.length);

        updateStatsCards(students);
        renderStudentTable(filteredStudents);
        updatePagination(filteredStudents);
      } catch (error) {
        console.error(error);
        showMessage("Error loading data: " + error.message, "error");
      }
    }

    function renderStudentTable(students) {
      const paginatedStudents = students.slice(
        (currentPage - 1) * pageSize,
        currentPage * pageSize
      );

      let html = "";
      paginatedStudents.forEach((student) => {
        const status = (student.status || "unknown").toLowerCase();
        const statusClass = `status-${status}`;
        console.log(student.profile_image);

        html += `
          <tr>
            <td>${student.roll_no || "-"}</td>
            <td><img src="${student.profile_image || "default-avatar.png"
          }" alt="Profile" style="width:50px;height:50px;border-radius:50%;object-fit:cover;" onerror="this.src=''"></td>
            <td>${student.name || "-"}</td>
            <td>${student.father_name || "-"}</td>
            <td>${student.phone || "-"}</td>
            <td>${student.cnic || "-"}</td>
            <td>${student.campus || "-"}</td>
            <td>${student.gender || "-"}</td>
            <td>${student.course || "-"}</td>
            <td>
              <div class="status-wrapper">
                <div class="status-container ${statusClass}" data-student-id="${student.id
          }">
                  <div class="current-status">
                    ${status}
                    <i class="fas fa-caret-down"></i>
                  </div>
                  <div class="status-dropdown">
                    <div class="status-option status-enrolled" data-status="enrolled">Enrolled</div>
                    <div class="status-option status-completed" data-status="completed">Completed</div>
                    <div class="status-option status-dropout" data-status="dropout">Dropout</div>
                    <div class="status-option status-certified" data-status="certified">Certified</div>
                    <div class="status-option status-pending" data-status="pending">Pending</div>
                  </div>
                </div>
              </div>
            </td>
            <td>
              <div class="action-btns">
                <button class="btn btn-view" onclick="showStudentDetails(${student.id
          }, event)">
                  <i class="fas fa-eye"></i>
                </button>
                <button class="btn btn-edit" onclick="editStudent(${student.id
          }, event)">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-delete" onclick="deleteStudent(${student.id
          }, event)">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
            </td>
          </tr>
          `;
      });
      document.querySelector("#studentTable tbody").innerHTML = html;
      setupDropdownPositioning();
    }

    function setupDropdownPositioning() {
      document.querySelectorAll(".current-status").forEach((el) => {
        el.addEventListener("click", function (e) {
          e.stopPropagation();
          const dropdown = this.nextElementSibling;
          const container = this.parentElement;

          // Close all other dropdowns
          document.querySelectorAll(".status-dropdown").forEach((d) => {
            if (d !== dropdown) d.style.display = "none";
          });

          // Toggle current dropdown
          if (dropdown.style.display === "block") {
            dropdown.style.display = "none";
          } else {
            dropdown.style.display = "block";

            // Calculate position
            const tableBody = document.querySelector("#studentTable tbody");
            const tableRect = tableBody.getBoundingClientRect();
            const dropdownRect = dropdown.getBoundingClientRect();
            const statusRect = this.getBoundingClientRect();

            // Check if there's space below
            const spaceBelow = tableRect.bottom - statusRect.bottom;
            const spaceAbove = statusRect.top - tableRect.top;

            if (
              spaceBelow < dropdownRect.height &&
              spaceAbove > dropdownRect.height
            ) {
              // Show above if more space available
              dropdown.style.top = "auto";
              dropdown.style.bottom = "100%";
              dropdown.style.marginTop = "0";
              dropdown.style.marginBottom = "5px";
            } else {
              // Default to below
              dropdown.style.top = "100%";
              dropdown.style.bottom = "auto";
              dropdown.style.marginTop = "5px";
              dropdown.style.marginBottom = "0";
            }
          }
        });
      });

      // Click handler for status options
      document.querySelectorAll(".status-option").forEach((option) => {
        option.addEventListener("click", function () {
          const status = this.getAttribute("data-status");
          const container = this.closest(".status-container");
          const studentId = container.getAttribute("data-student-id");

          updateStudentStatus(studentId, status);
        });
      });
    }

    // Close dropdowns when clicking outside
    document.addEventListener("click", function (e) {
      if (!e.target.closest(".status-container")) {
        document.querySelectorAll(".status-dropdown").forEach((dropdown) => {
          dropdown.style.display = "none";
        });
      }
    });

    async function updateStudentStatus(studentId, newStatus) {
      try {
        // Update in database
        const { error } = await client
          .from("students")
          .update({ status: newStatus })
          .eq("id", studentId);

        if (error) throw error;

        // Update local data
        const student = allStudents.find((s) => s.id === studentId);
        if (student) student.status = newStatus;

        // Update filtered data
        const filteredStudent = filteredStudents.find(
          (s) => s.id === studentId
        );
        if (filteredStudent) filteredStudent.status = newStatus;

        // Update UI
        const container = document.querySelector(
          `.status-container[data-student-id="${studentId}"]`
        );
        if (container) {
          // Remove all status classes
          container.classList.remove(
            "status-enrolled",
            "status-completed",
            "status-dropout",
            "status-certified",
            "status-pending",
            "status-unknown"
          );

          // Add new status class
          container.classList.add(`status-${newStatus}`);

          // Update displayed text
          container.querySelector(".current-status").innerHTML = `
              ${newStatus}
              <i class="fas fa-caret-down"></i>
            `;

          // Hide dropdown
          container.querySelector(".status-dropdown").style.display = "none";
        }

        showMessage("Status updated successfully", "success");
      } catch (error) {
        showMessage("Error updating status: " + error.message, "error");
      }
    }

    function updateStatsCards(students) {
      const totalStudents = students.length;
      const enrollStudents = students.filter(
        (s) => s.status === "enrolled"
      ).length;
      const pendingStudents = students.filter(
        (s) => s.status === "pending"
      ).length;

      statsContainer.innerHTML = `
        <div class="stat-card">
          <div class="stat-icon" style="background-color: var(--primary-color);">
            <i class="fas fa-users"></i>
          </div>
          <div class="stat-info">
            <p class="stat-title">Total Students</p>
            <p class="stat-value">${totalStudents}</p>
            <p class="stat-change up">
              <i class="fas fa-arrow-up"></i> ${Math.round(
        (totalStudents / (totalStudents + 10)) * 100
      )}% from last month
            </p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon" style="background-color: var(--success-color);">
            <i class="fas fa-user-check"></i>
          </div>
          <div class="stat-info">
            <p class="stat-title">Enrolled Students</p>
            <p class="stat-value">${enrollStudents}</p>
            <p class="stat-change up">
              <i class="fas fa-arrow-up"></i> ${Math.round(
        (enrollStudents / totalStudents) * 100
      )}% of total
            </p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon" style="background-color: var(--warning-color);">
            <i class="fas fa-user-clock"></i>
          </div>
          <div class="stat-info">
            <p class="stat-title">Pending Approval</p>
            <p class="stat-value">${pendingStudents}</p>
            <p class="stat-change ${pendingStudents > 0 ? "down" : "up"}">
              <i class="fas fa-${pendingStudents > 0 ? "arrow-up" : "check"
        }"></i>
              ${pendingStudents > 0 ? "Needs attention" : "All processed"}
            </p>
          </div>
        </div>
      `;
    }

    function updatePagination(students) {
      const totalPages = Math.ceil(students.length / pageSize);
      let paginationHTML = "";

      // Previous Button
      paginationHTML += `<button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'class="disabled"' : ""
        }>Previous</button>`;

      // Page Buttons
      for (let i = 1; i <= totalPages; i++) {
        paginationHTML += `<button onclick="changePage(${i})" ${i === currentPage ? 'class="disabled"' : ""
          }>${i}</button>`;
      }

      // Next Button
      paginationHTML += `<button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'class="disabled"' : ""
        }>Next</button>`;

      document.getElementById("pagination").innerHTML = paginationHTML;
    }

    function changePage(page) {
      const totalPages = Math.ceil(filteredStudents.length / pageSize);

      if (page < 1 || page > totalPages) return;

      currentPage = page;
      renderStudentTable(filteredStudents);
      updatePagination(filteredStudents);
    }

    function searchStudents() {
      const searchTerm = searchInput.value.trim().toLowerCase();
      console.log("Search term:", searchTerm);

      if (!searchTerm) {
        // If search is empty, show all students
        filteredStudents = [...allStudents];
        console.log("Showing all students:", filteredStudents.length);
      } else {
        // Filter students based on search term
        filteredStudents = allStudents.filter((student) => {
          const rollNoMatch =
            student.roll_no &&
            student.roll_no.toString().toLowerCase().includes(searchTerm);
          const cnicMatch =
            student.cnic &&
            student.cnic.toString().toLowerCase().includes(searchTerm);
          const nameMatch =
            student.name && student.name.toLowerCase().includes(searchTerm);

          return rollNoMatch || cnicMatch || nameMatch;
        });
        console.log("Filtered students:", filteredStudents);
      }

      if (filteredStudents.length === 0) {
        showMessage("No students found matching your search", "error");
      } else {
        showMessage(`Found ${filteredStudents.length} students`, "success");
      }

      currentPage = 1; // Reset to first page when searching
      renderStudentTable(filteredStudents);
      updatePagination(filteredStudents);
    }

    function showMessage(message, type) {
      const msgElement = document.getElementById("msg");
      msgElement.textContent = message;
      msgElement.className = type === "error" ? "error-msg" : "success-msg";
      msgElement.style.display = "block";
      setTimeout(() => {
        msgElement.style.display = "none";
      }, 3000);
    }

    function toggleFilterPanel() {
      filterPanel.classList.toggle("active");
      filterBtn.classList.toggle("active");
    }

    function applyFilters() {
      const status = document.getElementById("statusFilter").value;
      const course = document.getElementById("courseFilter").value;
      const branch = document.getElementById("branchFilter").value;
      const gender = document.getElementById("genderFilter").value;
      const qualification = document.getElementById(
        "qualificationFilter"
      ).value;
      const date = document.getElementById("dateFilter").value;

      currentFilters = {
        status,
        course,
        branch,
        gender,
        qualification,
        date,
      };

      filteredStudents = allStudents.filter((student) => {
        return (
          (status === "" || student.status === status) &&
          (course === "" || student.course === course) &&
          (branch === "" || student.branch === branch) &&
          (gender === "" || student.gender === gender) &&
          (qualification === "" || student.qualification === qualification)
          // Add date filtering logic here if needed
        );
      });

      currentPage = 1; // Reset to first page when applying filters
      renderStudentTable(filteredStudents);
      updatePagination(filteredStudents);
      toggleFilterPanel();
    }

    function resetFilters() {
      document.getElementById("statusFilter").value = "";
      document.getElementById("courseFilter").value = "";
      document.getElementById("branchFilter").value = "";
      document.getElementById("genderFilter").value = "";
      document.getElementById("qualificationFilter").value = "";
      document.getElementById("dateFilter").value = "";

      currentFilters = {
        status: "",
        course: "",
        branch: "",
        gender: "",
        qualification: "",
        date: "",
      };

      filteredStudents = [...allStudents];
      currentPage = 1; // Reset to first page when resetting filters
      renderStudentTable(filteredStudents);
      updatePagination(filteredStudents);
    }

    function showStudentDetails(studentId, event) {
      event.stopPropagation();
      const student = allStudents.find((s) => s.id === studentId);
      if (!student) return;

      currentStudentId = studentId;

      // Populate the side panel with student details
      document.getElementById("studentRollNo").textContent = `Roll No: ${student.roll_no || "-"
        }`;
      document.getElementById("studentName").textContent =
        student.name || "-";
      document.getElementById("studentFatherName").textContent =
        student.father_name || "-";
      document.getElementById("studentPhone").textContent =
        student.phone || "-";
      document.getElementById("studentCnic").textContent =
        student.cnic || "-";
      document.getElementById("studentQualification").textContent =
        student.qualification || "-";
      document.getElementById("studentBranch").textContent =
        student.branch || "-";
      document.getElementById("studentGender").textContent =
        student.gender || "-";
      document.getElementById("studentCourse").textContent =
        student.course || "-";
      document.getElementById("studentAddress").textContent =
        student.address || "-";
      document.getElementById("studentRegDate").textContent =
        student.created_at
          ? new Date(student.created_at).toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric",
          })
          : "-";

      // Set the student image
      const imgElement = document.getElementById("studentProfileImage");
      imgElement.src = student.profile_image || "default-avatar.png";
      imgElement.onerror = function () {
        this.src = "default-avatar.png";
      };

      // Update status badge
      const statusBadge = document.getElementById("studentStatusBadge");
      statusBadge.textContent = student.status
        ? student.status.charAt(0).toUpperCase() + student.status.slice(1)
        : "-";
      statusBadge.className = "status-badge";

      // Add appropriate status class
      if (student.status) {
        const statusClass = `status-${student.status.toLowerCase()}`;
        statusBadge.classList.add(statusClass);
      }

      // Show the side panel
      sidePanel.classList.add("active");
      overlay.classList.add("active");

      // Prevent body scroll when panel is open
      document.body.style.overflow = "hidden";
    }

    function closePanel() {
      sidePanel.classList.remove("active");
      overlay.classList.remove("active");
      currentStudentId = null;

      // Restore body scroll
      document.body.style.overflow = "";
    }

    // Close panel when clicking on overlay
    overlay.addEventListener("click", closePanel);

    // Prevent panel from closing when clicking inside it
    sidePanel.addEventListener("click", function (e) {
      e.stopPropagation();
    });

    function editCurrentStudent() {
      if (currentStudentId) {
        editStudent(currentStudentId);
      }
    }

    function deleteCurrentStudent() {
      if (currentStudentId) {
        if (confirm("Are you sure you want to delete this student?")) {
          deleteStudent(currentStudentId);
        }
      }
    }

    function editStudent(studentId, event) {
      if (event) event.stopPropagation();
      // Implement edit functionality 

    
      
      showMessage("Edit functionality not implemented yet", "error");
    }

    function deleteStudent(studentId, event) {
      if (event) event.stopPropagation();
      // Implement delete functionality
      showMessage("Delete functionality not implemented yet", "error");
    }



    // Initialize the application
    document.addEventListener("DOMContentLoaded", () => {
      checkSession();
      setupDropdownPositioning();
    });

  </script>
</body>

</html>